<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Values · LLVM.jl</title><meta name="title" content="Values · LLVM.jl"/><meta property="og:title" content="Values · LLVM.jl"/><meta property="twitter:title" content="Values · LLVM.jl"/><meta name="description" content="Documentation for LLVM.jl."/><meta property="og:description" content="Documentation for LLVM.jl."/><meta property="twitter:description" content="Documentation for LLVM.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">LLVM.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Usage</span><ul><li><a class="tocitem" href="../essentials/">Essentials</a></li><li><a class="tocitem" href="../types/">Types</a></li><li class="is-active"><a class="tocitem" href>Values</a><ul class="internal"><li><a class="tocitem" href="#General-APIs"><span>General APIs</span></a></li><li><a class="tocitem" href="#User-values"><span>User values</span></a></li><li><a class="tocitem" href="#Constant-values"><span>Constant values</span></a></li><li><a class="tocitem" href="#Uses"><span>Uses</span></a></li></ul></li><li><a class="tocitem" href="../modules/">Modules</a></li><li><a class="tocitem" href="../functions/">Functions</a></li><li><a class="tocitem" href="../blocks/">Basic blocks</a></li><li><a class="tocitem" href="../instructions/">Instructions</a></li><li><a class="tocitem" href="../metadata/">Metadata</a></li><li><a class="tocitem" href="../analyses/">Analyses</a></li><li><a class="tocitem" href="../transforms/">Transforms</a></li><li><a class="tocitem" href="../codegen/">Code generation</a></li><li><a class="tocitem" href="../execution/">Execution</a></li><li><a class="tocitem" href="../interop/">Julia integration</a></li></ul></li><li><span class="tocitem">API reference</span><ul><li><a class="tocitem" href="../../lib/essentials/">Essentials</a></li><li><a class="tocitem" href="../../lib/types/">Types</a></li><li><a class="tocitem" href="../../lib/values/">Values</a></li><li><a class="tocitem" href="../../lib/modules/">Modules</a></li><li><a class="tocitem" href="../../lib/functions/">Functions</a></li><li><a class="tocitem" href="../../lib/blocks/">Basic blocks</a></li><li><a class="tocitem" href="../../lib/instructions/">Instructions</a></li><li><a class="tocitem" href="../../lib/metadata/">Metadata</a></li><li><a class="tocitem" href="../../lib/analyses/">Analyses</a></li><li><a class="tocitem" href="../../lib/transforms/">Transforms</a></li><li><a class="tocitem" href="../../lib/codegen/">Code generation</a></li><li><a class="tocitem" href="../../lib/execution/">Execution</a></li><li><a class="tocitem" href="../../lib/interop/">Julia integration</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Usage</a></li><li class="is-active"><a href>Values</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Values</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/maleadt/LLVM.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/maleadt/LLVM.jl/blob/master/docs/src/man/values.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Values"><a class="docs-heading-anchor" href="#Values">Values</a><a id="Values-1"></a><a class="docs-heading-anchor-permalink" href="#Values" title="Permalink"></a></h1><p>Values are the basic building blocks of a program. They are the simplest form of data that can be manipulated by a program. Many things in LLVM are considered a value: not only constants, but also instructions, functions, etc.</p><h2 id="General-APIs"><a class="docs-heading-anchor" href="#General-APIs">General APIs</a><a id="General-APIs-1"></a><a class="docs-heading-anchor-permalink" href="#General-APIs" title="Permalink"></a></h2><p>The <code>Value</code> type is the abstract type that represents all values in LLVM. It supports a range of general APIs that are common to all values:</p><ul><li><code>value_type</code>: get the type of the value.</li><li><code>context</code>: get the context in which the value was created.</li><li><code>name!</code>/<code>name</code>: get or set the name of the value.</li></ul><h2 id="User-values"><a class="docs-heading-anchor" href="#User-values">User values</a><a id="User-values-1"></a><a class="docs-heading-anchor-permalink" href="#User-values" title="Permalink"></a></h2><p>A <code>User</code> is a value that can have other values as operands. It is the base type for instructions, functions, and other values that are composed of other values. It supports a few additional APIs:</p><ul><li><code>operands</code>: get the operands of the user.</li></ul><h2 id="Constant-values"><a class="docs-heading-anchor" href="#Constant-values">Constant values</a><a id="Constant-values-1"></a><a class="docs-heading-anchor-permalink" href="#Constant-values" title="Permalink"></a></h2><p>Many values are actually constant, i.e., they are known to be immutable at run time. Constant numbers are examples of constants, but also functions and global variables, because their address is immutable.</p><p>It is possible to quickly create all-zeros and all-ones constants using the <code>null</code> and <code>all_ones</code> functions:</p><pre><code class="language-julia-repl hljs">julia&gt; null(LLVM.Int1Type())
i1 false

julia&gt; all_ones(LLVM.FloatType())
float 0xFFFFFFFFE0000000</code></pre><h3 id="Constant-data"><a class="docs-heading-anchor" href="#Constant-data">Constant data</a><a id="Constant-data-1"></a><a class="docs-heading-anchor-permalink" href="#Constant-data" title="Permalink"></a></h3><p>There are several kinds of constant data that can be represented in LLVM. Singleton constants, which include null, undef, and poison values, can be created using constructors that take a single type as argument:</p><pre><code class="language-julia-repl hljs">julia&gt; PointerNull(LLVM.PointerType(LLVM.Int1Type()))
i1* null

julia&gt; UndefValue(LLVM.Int1Type())
i1 undef

julia&gt; PoisonValue(LLVM.Int1Type())
i1 poison</code></pre><p>Constant numbers can be created by passing a type and a value, or simply a value in which case the Julia type will be mapped to the corresponding LLVM type:</p><pre><code class="language-julia-repl hljs">julia&gt; ConstantInt(LLVM.Int1Type(), 1)
i1 true

julia&gt; ConstantInt(true)
i1 true

julia&gt; ConstantFP(LLVM.FloatType(), 1.0)
float 1.000000e+00

julia&gt; ConstantFP(1.0f0)
float 1.000000e+00</code></pre><p>It is possible to extract the value of a constant using the <code>convert</code> function:</p><pre><code class="language-julia-repl hljs">julia&gt; c = ConstantFP(Float16(1))
half 0xH3C00

julia&gt; convert(Float16, c)
Float16(1.0)</code></pre><p>Constant structures can be created using the <code>ConstantStruct</code> constructor:</p><pre><code class="language-julia-repl hljs">julia&gt; ty = LLVM.StructType([LLVM.Int32Type()])
{ i32 }

julia&gt; ConstantStruct(ty, [LLVM.ConstantInt(Int32(42))])
{ i32 } { i32 42 }

julia&gt; # short-hand where the LLVM type is inferred
       ConstantStruct([LLVM.ConstantInt(Int32(42))])
{ i32 } { i32 42 }</code></pre><p>Sequential constants, i.e., arrays and vectors, can be created using the <code>ConstantDataArray</code> and <code>ConstantDataVector</code> constructors, which again supports the shorthand of only passing Julia values:</p><pre><code class="language-julia-repl hljs">julia&gt; ConstantDataArray(LLVM.Int32Type(), Int32[1, 2])
[2 x i32] [i32 1, i32 2]

julia&gt; # short-hand where the LLVM type is inferred
       ConstantDataArray(Int32[1, 2])
[2 x i32] [i32 1, i32 2]</code></pre><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p><code>ConstantDataVector</code> is currently not implemented.</p></div></div><p>While <code>ConstantDataArray</code> only supports simple element types, <code>ConstantArray</code> supports arbitrary aggregates as elements:</p><pre><code class="language-julia-repl hljs">julia&gt; val = ConstantStruct([LLVM.ConstantInt(Int32(42))])
{ i32 } { i32 42 }

julia&gt; ty = value_type(val)
{ i32 }

julia&gt; ConstantArray(ty, [val])
[1 x { i32 }] [{ i32 } { i32 42 }]</code></pre><p>Both <code>ConstantDataArray</code> and <code>ConstantArray</code> can, to some extent, be manipulated with plain Julia array operations:</p><pre><code class="language-julia-repl hljs">julia&gt; arr = ConstantArray([1, 2])
[2 x i64] [i64 1, i64 2]

julia&gt; length(arr)
2

julia&gt; arr[1]
i64 1</code></pre><h3 id="Constant-expressions"><a class="docs-heading-anchor" href="#Constant-expressions">Constant expressions</a><a id="Constant-expressions-1"></a><a class="docs-heading-anchor-permalink" href="#Constant-expressions" title="Permalink"></a></h3><p>Constant expressions are a way to represent computations that are known at compile time. Their support in LLVM is diminishing, and their results are often constant-folded to other constants, but the ones that remain can be constructed with <code>const_</code>-prefixed functions in LLVM.jl:</p><pre><code class="language-julia-repl hljs">julia&gt; const_neg(ConstantInt(1))
i64 -1

julia&gt; const_inttoptr(ConstantInt(42), LLVM.PointerType(LLVM.Int1Type()))
i1* inttoptr (i64 42 to i1*)</code></pre><p>For the exact list of supported constant expressions, refer to the LLVM documentation.</p><h3 id="Inline-assembly"><a class="docs-heading-anchor" href="#Inline-assembly">Inline assembly</a><a id="Inline-assembly-1"></a><a class="docs-heading-anchor-permalink" href="#Inline-assembly" title="Permalink"></a></h3><p>Inline assembly is a way to include raw assembly code in a program. It is often used to access features that are not directly supported by LLVM, or to optimize specific parts of a program.</p><p>The <code>InlineAsm</code> constructor takes a function type, assembly string, constraints string, and a boolean indicating whether the assembly has side effects:</p><pre><code class="language-julia-repl hljs">julia&gt; InlineAsm(LLVM.FunctionType(LLVM.VoidType()), &quot;nop&quot;, &quot;&quot;, false)
void ()* asm &quot;nop&quot;, &quot;&quot;</code></pre><p>For more details on inline assembly, particularly the format of the constraints string, refer to the LLVM documentation.</p><h3 id="Global-values"><a class="docs-heading-anchor" href="#Global-values">Global values</a><a id="Global-values-1"></a><a class="docs-heading-anchor-permalink" href="#Global-values" title="Permalink"></a></h3><p>Global values are values that are encoded at the top level of a module. They support a couple of additional APIs:</p><ul><li><code>global_value_type</code>: get the type of the global value.</li><li><code>isdeclaration</code>: whether the global value is a declaration, i.e., it does not have a body.</li><li><code>linkage</code>/<code>linkage!</code>: get or set the linkage of the global value.</li><li><code>visibility</code>/<code>visibility!</code>: get or set the visibility of the global value.</li><li><code>section</code>/<code>section!</code>: get or set the section of the global value.</li><li><code>alignment</code>/<code>alignment!</code>: get or set the alignment of the global value.</li><li><code>dllstorage</code>/<code>dllstorage!</code>: get or set the DLL storage class of the global value.</li><li><code>unnamed_addr</code>/<code>unnamed_addr!</code>: get or set whether the global value has an unnamed address.</li></ul><p>The most common type of global value is the global variable, which can be created using the <code>GlobalVariable</code> constructor:</p><pre><code class="language-julia-repl hljs">julia&gt; mod = LLVM.Module(&quot;SomeModule&quot;);

julia&gt; ty = LLVM.Int32Type();

julia&gt; gv = GlobalVariable(mod, ty, &quot;SomeGV&quot;)
@SomeGV = external global i32</code></pre><p>Global variables support additional APIs:</p><ul><li><code>initializer</code>/<code>initializer!</code>: get or set the initializer of the global variable to a constant value (pass <code>nothing</code> to remove the initializer).</li><li><code>isthreadlocal</code>/<code>isthreadlocal!</code>: get or set whether the global variable is thread-local.</li><li><code>isconstant</code>/<code>isconstant!</code>: get or set whether the global variable is constant.</li><li><code>isextinit</code>/<code>isextinit!</code>: get or set whether the global variable is externally initialized.</li><li><code>erase!</code>: delete the global variable from its parent module, and delete the object.</li></ul><h2 id="Uses"><a class="docs-heading-anchor" href="#Uses">Uses</a><a id="Uses-1"></a><a class="docs-heading-anchor-permalink" href="#Uses" title="Permalink"></a></h2><p>It is possible to inspect the uses of a value using the iterator returned by the <code>uses</code> function. This iterator returns <code>Use</code> objects which contain both the user and the original value:</p><pre><code class="language-julia-repl hljs">julia&gt; c1 = ConstantInt(42);

julia&gt; c2 = const_inttoptr(c1, LLVM.PointerType(LLVM.Int1Type()));

julia&gt; use = only(uses(c1));

julia&gt; user(use)
i1* inttoptr (i64 42 to i1*)

julia&gt; value(use)
i64 42</code></pre><p>It is also possible to <em>replace</em> uses of a value using the <code>replace_uses!</code> function (commonly referred to as &quot;RAUW&quot; in LLVM):</p><pre><code class="language-julia-repl hljs">julia&gt; inst1
%2 = add i64 %1, %0

julia&gt; inst2
ret i64 %2

julia&gt; replace_uses!(inst1, ConstantInt(Int64(42)))

julia&gt; inst2
ret i64 42</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../types/">« Types</a><a class="docs-footer-nextpage" href="../modules/">Modules »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Wednesday 18 September 2024 20:28">Wednesday 18 September 2024</span>. Using Julia version 1.10.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
